<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
</head>
<body>
    <script>

    function findLowestStat(baseArray) {
        let lowestBase = Math.min(...baseArray);
        let lowestArray = [];

        for (let i = 0; i < 4; i++) {
            if (baseArray[i] == lowestBase) {
                switch (i) {
                    case 0:
                        lowestArray.push("agility");
                        break;
                    case 1:
                        lowestArray.push("strength");
                        break;
                    case 2:
                        lowestArray.push("focus");
                        break;
                    case 3:
                        lowestArray.push("intellect");
                }
            }
        }

            console.log(`[Checkpoint] lowestArray: ${lowestArray}`);
            return lowestArray;
        }

        function findHighestStat(baseArray) {
            let indexHighest = baseArray.indexOf(Math.max(...baseArray));

            switch (indexHighest) {
                case 0:
                    return "agility";
                case 1:
                    return "strength";
                case 2:
                    return "focus";
                case 3:
                    return "intellect";
                default:
                    return -1;
            }
        }

        function specialTraitSelect() {
            let traitSelected = event.target.value;
            traitIndex = specialTraits.findIndex((traits) => { return traits.traitName == traitSelected; });
            let baseStats = [];
            let arr2 = ["#end-agility", "#end-strength", "#end-focus", "#end-intellect"];

            for (let i = 0; i < 4; i++) {
                baseStats[i] = document.querySelector(arr2[i]).value;
            }

            if (specialTraits[traitIndex].traitName == "immersedIn") {
                for (let i = 0; i < 4; i++) {
                    document.querySelector(arr2[i]).value = specialTraits[traitIndex].stats[i];
                }

                let highestEnd = "#end-".concat(findHighestStat(baseStats));
                document.querySelector(highestEnd).value = 150;
            }
            else {
                for (let i = 0; i < 4; i++) {
                    document.querySelector(arr2[i]).value = specialTraits[traitIndex].stats[i];
                }
            }
        }

        function normalTraitSelect() {
            let baseStats = [];
            let arr2 = ["#start-agility", "#start-strength", "#start-focus", "#start-intellect"];
            let arr3 = ["#end-agility", "#end-strength", "#end-focus", "#end-intellect"];

            for (let i = 0; i < 4; i++) {
                baseStats[i] = Number(document.querySelector(arr2[i]).value);
            }


            console.log(baseStats);

            let traitSelected = event.target.value;
            traitIndex = normalTraits.findIndex((traits) => { return traits.traitName == traitSelected; });

            let lowestBaseArray = findLowestStat(baseStats);
            let highestReq = normalTraits[traitIndex].highest;
            let lowestReq = normalTraits[traitIndex].lowest;
            let reqArray = new Array(4).fill(0);

            console.log(`[Checkpoint] lowestReq: ${lowestReq}`);

            // if (lowestBaseArray.length != 1) {

            // }
            // else {
            if (lowestBaseArray.indexOf(lowestReq) < 0) {
                let iLowestReq = statList.indexOf(lowestReq);
                for (let i = 0; i < 4; i++) {
                    if (baseStats[iLowestReq] > baseStats[i]) {
                        reqArray[i] = baseStats[iLowestReq] + 1;

                    }
                    // else {
                    //     reqArray[iLowestReq] = baseStats[iLowestReq];
                    // }
                }
            }

            console.log(`[Checkpoint] reqArray: ${reqArray}`);

            
            let highestBase = statList[reqArray.indexOf(Math.max(...reqArray))];

            if (highestBase == highestReq) {
                reqArray[statList.indexOf(highestReq)] = baseStats[statList.indexOf(highestReq)]; // index of highest required stat
            }
            else {
                reqArray[statList.indexOf(highestReq)] = baseStats[statList.indexOf(highestBase)] + 1;
            }

            console.log(`[Checkpoint] reqArray: ${reqArray}`);

            // ***handle null exception later***
            // if (lowestReq == null) {
            //     if ()
            // }

            // for (stat of lowestBaseArray) {
            //     stat == lowestReq ? 
            // }
            for (let i = 0; i < 4; i++) {
                document.querySelector(arr3[i]).value = reqArray[i];
            }
        }

    </script>
</body>
</html>
